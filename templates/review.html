{% extends "base.html" %}

{% block content %}
<h1>üîÅ –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Å–ª–æ–≤</h1>

{% if message %}
    <p><strong>{{ message }}</strong></p>
{% elif error %}
    <p style="color: red;">{{ error }}</p>
{% else %}
    <div class="card">
        {% if card.image %}
            <div style="text-align: center; margin-bottom: 20px;">
                <img src="{{ card.image.url }}" alt="{{ card.word }}" style="max-width: 300px; height: auto; border-radius: 8px;">
            </div>
        {% endif %}
        <p>
            <strong>–°–ª–æ–≤–æ:</strong> {{card.word}}
            <button type="button" class="btn-audio" onclick="playAudio('{{ card.word }}')">üîä</button>
        </p>
<p>
    <strong>–ü–µ—Ä–µ–≤–æ–¥:</strong>
    <span id="translation" style="color: gray; transition: color 0.3s;">??? (–Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å")</span>
    <button type="button" class="btn-audio" onclick="playAudio('{{ card.translation }}')">üîä</button>
</p>

<button type="button" onclick="
    document.getElementById('translation').textContent = '{{ card.translation }}';
    document.getElementById('translation').style.color = 'black';
">–ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>



    </div>

    <p><strong>–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–≤—Ç–æ—Ä–∏—Ç—å:</strong> {{ due_count }} —Å–ª–æ–≤</p>

    <form method="post">
        {% csrf_token %}
        <p>–û—Ü–µ–Ω–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ª–µ–≥–∫–æ –≤—ã –≤—Å–ø–æ–º–Ω–∏–ª–∏:</p>
        <button type="submit" name="quality" value="1">1 ‚Äî –°–æ–≤—Å–µ–º –Ω–µ –ø–æ–º–Ω–∏–ª</button>
        <button type="submit" name="quality" value="2">2 ‚Äî –° —Ç—Ä—É–¥–æ–º</button>
        <button type="submit" name="quality" value="3">3 ‚Äî –•–æ—Ä–æ—à–æ</button>
        <button type="submit" name="quality" value="4">4 ‚Äî –û—Ç–ª–∏—á–Ω–æ</button>
    </form>
{% endif %}

<a href="/progress/">‚Üê –ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–≥—Ä–µ—Å—Å—É</a>

<script>
function playAudio(text) {
    if (!text) return;
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫
    const lang = /[–∞-—è—ë]/i.test(text) ? 'ru' : 'en';
    const url = `/words/speak/?text=${encodeURIComponent(text)}&lang=${lang}`;
    const audio = new Audio(url);
    audio.play().catch(e => console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e));
}
</script>

<style>
.btn-audio {
    background: none;
    border: none;
    font-size: 1.2em;
    cursor: pointer;
    margin-left: 4px;
}
.btn-audio:hover {
    transform: scale(1.2);
}
</style>

{% endblock %}

